!function(t,e,a,n){"use strict";function r(e,a){this.element=e,this.settings=t.extend({},s,a),this._defaults=s,this._name=i,this.currentDate=new Date,this.events=a.events,this.init()}var i="simpleCalendar",s={months:["january","february","march","april","may","june","july","august","september","october","november","december"],days:["sunday","monday","tuesday","wenesday","thursday","friday","saturday"],minDate:"YYYY-MM-DD",maxDate:"YYYY-MM-DD",insertEvent:!0,displayEvent:!0,fixedStartDay:!0,events:[],insertCallback:function(){}};t.extend(r.prototype,{init:function(){var e=t(this.element),a=this.currentDate,n=(this.events,t('<div class="calendar"></div>')),r=t('<header><h2 class="month"></h2><a class="btn btn-prev" href="#"><</a><a class="btn btn-next" href="#">></a></header>');this.updateHeader(a,r),n.append(r),this.buildCalendar(a,n),e.append(n),this.bindEvents()},updateHeader:function(t,e){e.find(".month").html(this.settings.months[t.getMonth()])},buildCalendar:function(e,a){var n=this;a.find("table").remove();for(var r=t("<table></table>"),i=t("<thead></thead>"),s=t("<tbody></tbody>"),d=1;d<=this.settings.days.length;d++)i.append(t("<td>"+this.settings.days[d%7].substring(0,3)+"</td>"));for(var o=e.getFullYear(),h=e.getMonth(),l=new Date(o,h,1);1!=l.getDay();)l.setDate(l.getDate()-1);for(var c=new Date(o,h+1,0);0!=c.getDay();)c.setDate(c.getDate()+1);console.log(n);for(var u=l;c>=u;u.setDate(u.getDate())){for(var f=t("<tr></tr>"),d=0;7>d;d++){var D=t('<td><a href="#" class="day">'+u.getDate()+"</a></td>"),g=u.getFullYear()+"-"+u.getMonth()+"-"+u.getDay(),g=this.formatToYYYYMMDD(u);console.log(g),-1!==t.inArray(this.formatToYYYYMMDD(u),n.events)&&(console.log("found"),D.find(".day").addClass("event")),u.toDateString()===(new Date).toDateString()&&D.find(".day").addClass("today"),u.getMonth()!=e.getMonth()&&D.find(".day").addClass("wrong-month"),D.on("click",function(e){n.fillUp(t(n.element),e.pageX,e.pageY)}),f.append(D),u.setDate(u.getDate()+1)}s.append(f)}r.append(i),r.append(s);var p=t('<div class="event-container"></div>');a.append(r),a.append(p)},bindEvents:function(){var e=this;t(".btn-prev").click(function(){e.currentDate.setMonth(e.currentDate.getMonth()-1),e.buildCalendar(e.currentDate,t(".calendar")),e.updateHeader(e.currentDate,t(".calendar header"))}),t(".btn-next").click(function(){e.currentDate.setMonth(e.currentDate.getMonth()+1),e.buildCalendar(e.currentDate,t(".calendar")),e.updateHeader(e.currentDate,t(".calendar header"))})},fillUp:function(e,a,n){var r=e.offset(),i=t('<div class="filler" style=""></div>');i.css("left",a-r.left),i.css("top",n-r.top),t(".calendar").append(i),i.animate({width:"300%",height:"300%"},500,function(){t(".event-container").show(),i.hide()})},empty:function(e,a,n){var r=(e.offset(),t(".filler"));r.css("width","300%"),r.css("height","300%"),r.show(),t(".event-container").hide(),r.animate({width:"0%",height:"0%"},500,function(){r.remove()})},formatToYYYYMMDD:function(t){var e=new Date(t),a=""+(e.getMonth()+1),n=""+e.getDate(),r=e.getFullYear();return a.length<2&&(a="0"+a),n.length<2&&(n="0"+n),[r,a,n].join("-")}}),t.fn[i]=function(e){return this.each(function(){t.data(this,"plugin_"+i)||t.data(this,"plugin_"+i,new r(this,e))})}}(jQuery,window,document);